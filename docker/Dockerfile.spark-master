FROM apache/spark:3.5.0-python3

USER root

# Install additional Python packages
RUN pip install --no-cache-dir \
    pandas \
    numpy \
    matplotlib \
    seaborn

# Switch back to spark user
USER spark

# Set environment variables
ENV SPARK_MASTER_HOST=spark-master
ENV SPARK_MASTER_PORT=7077
ENV SPARK_MASTER_WEBUI_PORT=8080

# Expose ports
EXPOSE 7077 8080

# Start Spark master
CMD ["/opt/spark/bin/spark-class", "org.apache.spark.deploy.master.Master"]
