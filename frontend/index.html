<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° PySpark Playground</title>
    <link rel="stylesheet" href="static/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header class="header">
            <h1>‚ö° PySpark Playground</h1>
            <p>Manage your Spark cluster and create notebooks</p>
        </header>

        <main class="main-content">
            <!-- Cluster Status Card -->
            <section class="card status-card">
                <div class="card-header">
                    <h2>üìä Cluster Status</h2>
                    <button class="btn-refresh" onclick="refreshClusterStatus()" title="Refresh Status">
                        <span id="refreshIcon">üîÑ</span>
                    </button>
                </div>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-label">Status:</span>
                        <span class="status-value" id="clusterStatus">
                            <span class="status-badge status-offline">Offline</span>
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Workers:</span>
                        <span class="status-value" id="workerCount">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Master UI:</span>
                        <span class="status-value">
                            <a href="http://localhost:8080" target="_blank" id="masterLink"
                                class="status-link disabled">localhost:8080</a>
                        </span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">JupyterLab:</span>
                        <span class="status-value">
                            <a href="http://localhost:8888" target="_blank" id="jupyterLink"
                                class="status-link">localhost:8888</a>
                        </span>
                    </div>
                </div>

                <!-- Cluster Controls -->
                <div class="cluster-controls">
                    <button class="btn btn-success" onclick="startCluster()" id="btnStart">
                        ‚ñ∂ Start Cluster
                    </button>
                    <button class="btn btn-danger" onclick="stopCluster()" id="btnStop">
                        ‚èπ Stop Cluster
                    </button>
                </div>
            </section>

            <!-- Two Column Layout -->
            <div class="two-column">
                <!-- Cluster Configuration Card -->
                <section class="card config-card">
                    <div class="card-header">
                        <h2>‚öôÔ∏è Worker Configuration</h2>
                        <button class="btn-small" onclick="addWorker()">+ Add Worker</button>
                    </div>

                    <div class="workers-config-table">
                        <table id="workersTable" class="config-table">
                            <thead>
                                <tr>
                                    <th>Worker</th>
                                    <th>Memory</th>
                                    <th>CPU Cores</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="workersTableBody">
                                <!-- Workers will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>

                    <button onclick="applyConfig()" class="btn btn-primary" style="margin-top: 20px; width: 100%;">
                        ‚úì Apply Configuration & Restart
                    </button>
                </section>

                <!-- Notebooks Card -->
                <section class="card notebook-card">
                    <div class="card-header">
                        <h2>üìì Notebooks</h2>
                        <button class="btn btn-create" onclick="showCreateNotebookModal()">
                            + New Notebook
                        </button>
                    </div>
                    <div id="notebookList" class="notebook-list">
                        <p class="empty-state">No notebooks created yet.</p>
                    </div>
                </section>
            </div>

            <!-- Logs Card -->
            <section class="card logs-card">
                <div class="card-header">
                    <h2>üìã Cluster Logs</h2>
                    <button class="btn-small" onclick="clearLogs()">Clear</button>
                </div>
                <div id="logsContainer" class="logs-container">
                    <div class="logs-empty">No logs yet. Logs will appear when you perform cluster operations.</div>
                </div>
            </section>
        </main>
    </div>

    <!-- Create Notebook Modal -->
    <div id="createNotebookModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Notebook</h2>
                <button class="modal-close" onclick="hideCreateNotebookModal()">&times;</button>
            </div>
            <form id="createNotebookForm" onsubmit="createNotebook(event)">
                <div class="form-group">
                    <label for="notebookName">Notebook Name</label>
                    <input type="text" id="notebookName" class="form-control" placeholder="My Analysis" required>
                </div>
                <div class="form-group">
                    <label for="notebookTemplate">Template</label>
                    <select id="notebookTemplate" class="form-control">
                        <option value="welcome">Welcome & Setup</option>
                        <option value="dataframe_basics">DataFrame Basics</option>
                        <option value="sql_queries">SQL Queries</option>
                        <option value="ml_example">Machine Learning Example</option>
                        <option value="blank">Blank Notebook</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideCreateNotebookModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Notebook</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="static/app.js"></script>
</body>

</html>